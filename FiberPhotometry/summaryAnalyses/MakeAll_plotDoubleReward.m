
% directories with no novelty, no double

directory = [ ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220706-134020'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220707-083727'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220708-135903'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220711-141041'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220712-142608'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220713-134534'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220714-174931'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220715-123644'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220719-123842'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220720-131802'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220721-120936'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h3\LinearTrack\DA2h3-220722-172503'} ; ...
    
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220706-142252'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220707-092636'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220708-144410'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220711-144600'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220712-150855'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220713-142556'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220714-183901'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220715-131631'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220719-131151'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220720-134926'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220721-124035'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\DA2h4\LinearTrack\DA2h4-220722-180225'} ; ...
    
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220706-110531'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220707-095920'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220708-110730'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220711-114211'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220712-111806'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220713-112318'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220714-114809'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220715-103613'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220719-104151'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220720-111104'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220721-102236'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h2 (Named NE2m3)\LinearTrack\NE2h2-220722-154009'} ; ...
    
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220706-114753'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220707-103131'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220708-113940'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220711-121411'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220712-115326'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220713-115612'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220714-122057'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220715-110545'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220719-110905'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220720-114338'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220721-105250'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h4\LinearTrack\NE2h4-220722-160818'} ; ...
    
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220706-125821'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220707-110451'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220708-130251'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220711-132555'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220712-134504'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220713-130509'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220714-165743'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220715-113456'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220719-114232'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220720-123755'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220721-113117'} ; ...
    {'R:\McKenzieLab\DANEHippocampalResponse\NE2h8\LinearTrack\NE2h8-220722-164255'} ; ...
    ];

nSessions = length(directory);
%%
clear left right ts_PETH
for i = 1:nSessions
    [singles{i},doubles{i},other_side{i},ts_PETH]  = plotAllDoubleReward(directory{i});
    i
    
end
save('double_reward_linearTrack.mat','-v7.3')
%%

kp_DA = cellfun(@any,regexp(directory,'DA2h4'));
kp_NE = cellfun(@any,regexp(directory,'NE2h8'));% & cellfun(@any,regexp(directory,'NE2m3'));  


plotIt = false;
col = {'k','r'};

for i = 1
    
    if  i ==1
        kp = kp_DA;
    else
        kp = kp_NE;
        
    end
    singles1 = cellfun(@double,singles(kp),'uni',0);
    doubles1 = cellfun(@double,doubles(kp),'uni',0);
    other_side1 = cellfun(@double,other_side(kp),'uni',0);
    
    singles1 = cell2mat(singles1');
    doubles1 = cell2mat(doubles1');
    other_side1 = cell2mat(other_side1');
    h = figure;
   % ax  = tight_subplot(3,1);
    for j = 1:2
      
        switch j
            case 1
                data = singles1;
            case 2
                data = doubles1 ;
            case 3
                data = other_side1;
        end
        
        
        %  data  =[left1;right1];
          data = nanzscore(data,[],2);
        
        plotMeanSEM(ts_PETH,data,col{j})
        
   % ylim([-1 2])    
    end
    if plotIt
    if i ==1
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_DAZ.fig','fig')
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_DAZ.png','png')
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_DAZ.eps','epsc')
        
        
    else
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_NEZ.fig','fig')
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_NEZ.png','png')
        saveas(h,'R:\McKenzieLab\DANEHippocampalResponse\Figures\double_reward_mean_NEZ.eps','epsc')
    end
    end

end


%%
 kp = kp_NE;
singles1 = cellfun(@double,singles(kp),'uni',0);
doubles1 = cellfun(@double,doubles(kp),'uni',0);


singles2 = cell2mat(cellfun(@(a) nanmean(a,1),singles1,'uni',0)');
doubles2 = cell2mat(cellfun(@(a) nanmean(a,1),doubles1,'uni',0)');

u_sing = nanmean(singles2(:,ix1:ix2),2);
u_doub = nanmean(doubles2(:,ix1:ix2),2);
figure
plot(u_sing,u_doub,'o')
ylim([-1 2.5])
xlim([-1 2.5])
axis square

hold on
plot(-1:3,-1:3)